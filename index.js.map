{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst API_KEY = '45506482-0746cd613ccb32219c9653431';\nconst BASE_URL = 'https://pixabay.com/api/';\n\nexport async function fetchPhotos(query, page = 1, perPage = 15) {\n  if (!query.trim()) {\n    iziToast.error({\n      message: 'Please enter a search query!',\n      position: 'topRight',\n    });\n    return [];\n  }\n\n  const axiosOptions = {\n    params: {\n      key: API_KEY,\n      q: query,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: 'true',\n      per_page: perPage,\n      page: page,\n    },\n  };\n\n  try {\n    document.querySelector('.loader').classList.remove('hidden');\n    const response = await axios.get(BASE_URL, axiosOptions);\n    const data = response.data;\n\n    if (data.hits.length === 0) {\n      iziToast.error({\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        position: 'topRight',\n      });\n    }\n    return data;\n  } catch (error) {\n    console.log(error);\n    iziToast.error({\n      message:\n        'An error occurred while fetching images. Please try again later.',\n      position: 'topRight',\n    });\n    return [];\n  } finally {\n    document.querySelector('.loader').classList.add('hidden');\n  }\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nlet lightbox;\n\nconst createGalleryCardTemplate = imgInfo => {\n  return ` <li class=\"gallery-card\">\n      <a href=\"${imgInfo.largeImageURL}\" class=\"gallery-item\">\n        <img class=\"gallery-img\" src=\"${imgInfo.webformatURL}\" alt=\"${imgInfo.tags}\" loading=\"lazy\" />\n        <div class=\"info\">\n          <p class=\"info-item\"><b>Likes:</b> ${imgInfo.likes}</p>\n          <p class=\"info-item\"><b>Views:</b> ${imgInfo.views}</p>\n          <p class=\"info-item\"><b>Comments:</b> ${imgInfo.comments}</p>\n          <p class=\"info-item\"><b>Downloads:</b> ${imgInfo.downloads}</p>\n        </div>\n      </a>\n    </li>`;\n};\n\nexport function addImagesToGallery(images) {\n  const galleryEl = document.querySelector('.gallery');\n  const markup = images\n    .map(imgDetails => createGalleryCardTemplate(imgDetails))\n    .join('');\n  galleryEl.insertAdjacentHTML('beforeend', markup);\n\n  lightbox = new SimpleLightbox('.gallery a', {\n    captions: true,\n    captionsData: 'alt',\n    captionDelay: 250,\n  });\n\n  lightbox.refresh();\n}\n","import iziToast from 'izitoast';\nimport { fetchPhotos } from './js/pixabay-api';\nimport { addImagesToGallery } from './js/render-functions';\n\nconst searchForm = document.querySelector('.submit-form');\nconst searchInput = document.querySelector('.search-input');\nconst galleryEl = document.querySelector('.gallery');\nconst loadBtn = document.querySelector('.load-btn');\n\nlet page = 1;\nconst perPage = 15;\nlet query = '';\nlet totalPages = 0;\n\nfunction clearGallery() {\n  galleryEl.innerHTML = '';\n}\n\nsearchForm.addEventListener('submit', async event => {\n  event.preventDefault();\n  query = searchInput.value.trim();\n\n  if (!query) {\n    iziToast.error({\n      message: 'Please enter a search query!',\n      position: 'topRight',\n    });\n    return;\n  }\n\n  clearGallery();\n  page = 1;\n  loadBtn.classList.add('hidden-btn');\n\n  try {\n    const { hits, totalHits } = await fetchPhotos(query, page, perPage);\n    if (hits.length > 0) {\n      addImagesToGallery(hits);\n      totalPages = Math.ceil(totalHits / perPage);\n\n      if (page < totalPages) {\n        loadBtn.classList.remove('hidden-btn');\n      } else {\n        iziToast.info({\n          message: \"We're sorry, but you've reached the end of search results.\",\n          position: 'topRight',\n        });\n      }\n    } else {\n      loadBtn.classList.add('hidden-btn');\n    }\n  } catch (error) {\n    iziToast.error({\n      message: 'An error occurred. Please try again later.',\n      position: 'topRight',\n    });\n  }\n});\n\nloadBtn.addEventListener('click', async () => {\n  page += 1;\n  try {\n    const { hits } = await fetchPhotos(query, page, perPage);\n    if (hits.length > 0) {\n      addImagesToGallery(hits);\n      const { height } = document\n        .querySelector('.gallery-card')\n        .getBoundingClientRect();\n      window.scrollBy({\n        top: height * 2,\n        behavior: 'smooth',\n      });\n\n      if (page >= totalPages) {\n        loadBtn.classList.add('hidden-btn');\n        iziToast.info({\n          message: \"We're sorry, but you've reached the end of search results.\",\n          position: 'topRight',\n        });\n      }\n    } else {\n      iziToast.info({\n        message: 'No more images to load',\n        position: 'topRight',\n      });\n    }\n  } catch (error) {\n    iziToast.error({\n      message:\n        'An error occurred while loading more images. Please try again later.',\n      position: 'topRight',\n    });\n  }\n});\n"],"names":["API_KEY","BASE_URL","fetchPhotos","query","page","perPage","iziToast","axiosOptions","data","axios","error","lightbox","createGalleryCardTemplate","imgInfo","addImagesToGallery","images","galleryEl","markup","imgDetails","SimpleLightbox","searchForm","searchInput","loadBtn","totalPages","clearGallery","event","hits","totalHits","height"],"mappings":"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"}